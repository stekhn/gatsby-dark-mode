(self.webpackChunkgatsby_dark_mode=self.webpackChunkgatsby_dark_mode||[]).push([[691],{1046:function(e,t,n){"use strict";n.d(t,{w_:function(){return u}});var o=n(7294),r={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=o.createContext&&o.createContext(r),l=function(){return l=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},l.apply(this,arguments)},i=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};function c(e){return e&&e.map((function(e,t){return o.createElement(e.tag,l({key:t},e.attr),c(e.child))}))}function u(e){return function(t){return o.createElement(s,l({attr:l({},e.attr)},t),c(e.child))}}function s(e){var t=function(t){var n,r=e.attr,a=e.size,c=e.title,u=i(e,["attr","size","title"]),s=a||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),o.createElement("svg",l({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,u,{className:n,style:l(l({color:e.color||t.color},t.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),c&&o.createElement("title",null,c),e.children)};return void 0!==a?o.createElement(a.Consumer,null,(function(e){return t(e)})):t(r)}},5837:function(e,t,n){var o=n(2109),r=n(7854);o({global:!0,forced:r.globalThis!==r},{globalThis:r})},5743:function(e,t,n){n(5837)},2569:function(e,t,n){"use strict";n.r(t),n.d(t,{Head:function(){return S},default:function(){return C}});var o=n(7294);function r(e,t,r,a){void 0===r&&(r=n.g),void 0===a&&(a={});var l=(0,o.useRef)(),i=a.capture,c=a.passive,u=a.once;(0,o.useEffect)((function(){l.current=t}),[t]),(0,o.useEffect)((function(){if(n.g&&n.g.addEventListener){var t=function(e){return l.current(e)},o={capture:i,passive:c,once:u};return n.g.addEventListener(e,t,o),function(){n.g.removeEventListener(e,t,o)}}}),[e,n.g,i,c,u])}n(5743);var a={},l=function(e,t,n){return a[e]||(a[e]={callbacks:[],value:n}),a[e].callbacks.push(t),{deregister:function(){var n=a[e].callbacks,o=n.indexOf(t);o>-1&&n.splice(o,1)},emit:function(n){a[e].value!==n&&(a[e].value=n,a[e].callbacks.forEach((function(e){t!==e&&e(n)})))}}};function i(e,t){if(void 0===t&&(t=void 0!==n.g&&n.g.localStorage?n.g.localStorage:"undefined"!=typeof globalThis&&globalThis.localStorage?globalThis.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:"undefined"!=typeof localStorage?localStorage:null),t){var a=(i=t,{get:function(e,t){var n=i.getItem(e);return null==n?"function"==typeof t?t():t:JSON.parse(n)},set:function(e,t){i.setItem(e,JSON.stringify(t))}});return function(t){return function(e,t,n){var a=n.get,i=n.set,c=(0,o.useRef)(null),u=(0,o.useState)((function(){return a(t,e)})),s=u[0],d=u[1];r("storage",(function(e){if(e.key===t){var n=JSON.parse(e.newValue);s!==n&&d(n)}})),(0,o.useEffect)((function(){return c.current=l(t,d,e),function(){c.current.deregister()}}),[e,t]);var f=(0,o.useCallback)((function(e){var n="function"==typeof e?e(s):e;i(t,n),d(n),c.current.emit(e)}),[s,i,t]);return[s,f]}(t,e,a)}}var i;return o.useState}var c=function(){},u={classList:{add:c,remove:c}},s=function(e,t,r){void 0===r&&(r=n.g);var a=e?i(e,t):o.useState,l=n.g.matchMedia?n.g.matchMedia("(prefers-color-scheme: dark)"):{},c={addEventListener:function(e,t){return l.addListener&&l.addListener(t)},removeEventListener:function(e,t){return l.removeListener&&l.removeListener(t)}},s="(prefers-color-scheme: dark)"===l.media,d=n.g.document&&n.g.document.body||u;return{usePersistedDarkModeState:a,getDefaultOnChange:function(e,t,n){return void 0===e&&(e=d),void 0===t&&(t="dark-mode"),void 0===n&&(n="light-mode"),function(o){e.classList.add(o?t:n),e.classList.remove(o?n:t)}},mediaQueryEventTarget:c,getInitialValue:function(e){return s?l.matches:e}}};function d(e,t){void 0===e&&(e=!1),void 0===t&&(t={});var n=t.element,a=t.classNameDark,l=t.classNameLight,i=t.onChange,c=t.storageKey;void 0===c&&(c="darkMode");var u=t.storageProvider,d=t.global,f=(0,o.useMemo)((function(){return s(c,u,d)}),[c,u,d]),m=f.getDefaultOnChange,g=f.mediaQueryEventTarget,h=(0,f.usePersistedDarkModeState)((0,f.getInitialValue)(e)),p=h[0],v=h[1],b=(0,o.useMemo)((function(){return i||m(n,a,l)}),[i,n,a,l,m]);return(0,o.useEffect)((function(){b(p)}),[b,p]),r("change",(function(e){return v(e.matches)}),g),{value:p,enable:(0,o.useCallback)((function(){return v(!0)}),[v]),disable:(0,o.useCallback)((function(){return v(!1)}),[v]),toggle:(0,o.useCallback)((function(){return v((function(e){return!e}))}),[v])}}var f=n(3494),m=function(e){var t=e.children,n=d(),r=n.value?{font:"#FED",background:"#321",border:"#CA7"}:{font:"#123",background:"#DEF",border:"#7AC"};return console.log("Layout (component):",n.value),(0,o.useEffect)((function(){console.log("Layout (useEffect):",n.value)}),[n.value]),o.createElement(f.ThemeProvider,{theme:r},o.createElement(g,null),t)},g=(0,f.createGlobalStyle)(["html{font-family:Tahoma,Verdana,sans-serif;font-size:1.2rem;line-height:1.5;color:",";background-color:",";border:","}body{margin:0;padding:3rem;}main{margin:0 auto;max-width:640px;}h1{margin-top:0;}a{color:inherit;}"],(function(e){return e.theme.font}),(function(e){return e.theme.background}),(function(e){return"1rem solid "+e.theme.border})),h=f.default.div.withConfig({displayName:"styledBox__Box",componentId:"sc-yambj8-0"})(["color:",";background-color:",";border:",";padding:1rem;p{&:first-child{margin-top:0;}&:last-child{margin-bottom:0;}}"],(function(e){return e.theme.font}),(function(e){return e.theme.background}),(function(e){return"1rem solid "+e.theme.border})),p=n(3750),v=f.default.div.withConfig({displayName:"styledDarkModeToogle__SwitchContainer",componentId:"sc-9n1pc7-0"})(["width:54px;height:26px;padding:0;border-radius:30px;transition:all 0.2s ease;"]),b=f.default.div.withConfig({displayName:"styledDarkModeToogle__SwitchCircle",componentId:"sc-9n1pc7-1"})(["position:absolute;top:2px;left:2px;width:22px;height:22px;border-radius:50%;box-sizing:border-box;transition:all 0.25s ease;"]),y=f.default.div.withConfig({displayName:"styledDarkModeToogle__SwitchIcon",componentId:"sc-9n1pc7-2"})(["position:absolute;top:4px;line-height:0;opacity:0;transition:opacity 0.25s ease;svg{align-items:center;display:flex;justify-content:center;position:relative;height:18px;width:18px;}"]),k=(0,f.default)(y).withConfig({displayName:"styledDarkModeToogle__SwitchIconLeft",componentId:"sc-9n1pc7-3"})(["left:7px;"]),E=(0,f.default)(y).withConfig({displayName:"styledDarkModeToogle__SwitchIconRight",componentId:"sc-9n1pc7-4"})(["right:7px;"]),w=f.default.div.withConfig({displayName:"styledDarkModeToogle__SwitchWrapper",componentId:"sc-9n1pc7-5"})(["display:inline-block;position:relative;vertical-align:sub;background-color:transparent;border:0;padding:0;margin-right:0.25rem;cursor:pointer;touch-action:pan-x;user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;","{background-color:",";}","{background-color:",";left:",";}","{opacity:",";}","{opacity:",";}"],v,(function(e){return e.isEnabled?"#FED":"#123"}),b,(function(e){return e.isEnabled?"#321":"#DEF"}),(function(e){return e.isEnabled?"30px":"2px"}),k,(function(e){return e.isEnabled?"1":"0"}),E,(function(e){return e.isEnabled?"0":"1"})),x=function(){var e=d();return console.log("Box (component):",e.value),(0,o.useEffect)((function(){console.log("Box (useEffect):",e.value)}),[e.value]),o.createElement(w,{onClick:e.toggle,isEnabled:e.value,"aria-checked":e.value,role:"switch",tabIndex:0},o.createElement(v,null,o.createElement(k,null,o.createElement(p.wOW,{color:"#321"})),o.createElement(E,null,o.createElement(p.kXG,{color:"#DEF"}))),o.createElement(b,null))},C=function(){return o.createElement(m,null,o.createElement("main",null,o.createElement("h1",null,"Gatsby Dark Mode Bug"),o.createElement("div",null,o.createElement(x,null)," ",o.createElement("em",null,"Change theme")),o.createElement("p",null,"Changing between themes works fine in development, but once the the Gatsby application gets built, the custom component's dark styles don't get applied when (re)loading the page. You can check out a deployed version of the page here:"," ",o.createElement("a",{href:"https://stekhn.github.io/gatsby-dark-mode/"},"https://stekhn.github.io/gatsby-dark-mode/")),o.createElement(h,null,o.createElement("p",null,"I'm a custom component (Box) and my style should always match the rest of the page. I get my styles from a global ",o.createElement("code",null,"theme"),", which gets injected by the ",o.createElement("code",null,"ThemeProvider"),"."),o.createElement("p",null,"For example, this is how my background color is defined:"),o.createElement("code",null,"background-color: ${({ theme }) => theme.background};")),o.createElement("p",null,"The dark mode for this site was implemented using the"," ",o.createElement("a",{href:""},"use-dark-mode")," React hook and the"," ",o.createElement("a",{href:"https://styled-components.com/docs/advanced#theming"},"styled-components ThemeProvider")," ","component.")))},S=function(){return o.createElement("title",null,"Gatsby Dark Mode Bug")}}}]);
//# sourceMappingURL=component---src-pages-index-tsx-55acd1f4c1c8b34b2b1f.js.map