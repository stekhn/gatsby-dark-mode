<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.24.4"/><title data-gatsby-head="true">Gatsby Dark Mode Bug</title><style data-styled="" data-styled-version="5.3.6">html{font-family:Tahoma,Verdana,sans-serif;font-size:1.2rem;line-height:1.5;color:#123;background-color:#DEF;border:1rem solid #7AC;}/*!sc*/
body{margin:0;padding:3rem;}/*!sc*/
main{margin:0 auto;max-width:640px;}/*!sc*/
h1{margin-top:0;}/*!sc*/
a{color:inherit;}/*!sc*/
data-styled.g1[id="sc-global-kmxqvu1"]{content:"sc-global-kmxqvu1,"}/*!sc*/
.dOgQpc{color:#123;background-color:#DEF;border:1rem solid #7AC;padding:1rem;}/*!sc*/
.dOgQpc p:first-child{margin-top:0;}/*!sc*/
.dOgQpc p:last-child{margin-bottom:0;}/*!sc*/
data-styled.g2[id="styledBox__Box-sc-yambj8-0"]{content:"dOgQpc,"}/*!sc*/
.eftICK{width:54px;height:26px;padding:0;border-radius:30px;-webkit-transition:all 0.2s ease;transition:all 0.2s ease;}/*!sc*/
data-styled.g3[id="styledDarkModeToogle__SwitchContainer-sc-9n1pc7-0"]{content:"eftICK,"}/*!sc*/
.boyQdn{position:absolute;top:2px;left:2px;width:22px;height:22px;border-radius:50%;box-sizing:border-box;-webkit-transition:all 0.25s ease;transition:all 0.25s ease;}/*!sc*/
data-styled.g4[id="styledDarkModeToogle__SwitchCircle-sc-9n1pc7-1"]{content:"boyQdn,"}/*!sc*/
.erBfQD{position:absolute;top:4px;line-height:0;opacity:0;-webkit-transition:opacity 0.25s ease;transition:opacity 0.25s ease;}/*!sc*/
.erBfQD svg{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:relative;height:18px;width:18px;}/*!sc*/
data-styled.g5[id="styledDarkModeToogle__SwitchIcon-sc-9n1pc7-2"]{content:"erBfQD,"}/*!sc*/
.hDnQUW{left:7px;}/*!sc*/
data-styled.g6[id="styledDarkModeToogle__SwitchIconLeft-sc-9n1pc7-3"]{content:"hDnQUW,"}/*!sc*/
.cfkHgN{right:7px;}/*!sc*/
data-styled.g7[id="styledDarkModeToogle__SwitchIconRight-sc-9n1pc7-4"]{content:"cfkHgN,"}/*!sc*/
.cwSObj{display:inline-block;position:relative;vertical-align:sub;background-color:transparent;border:0;padding:0;margin-right:0.25rem;cursor:pointer;touch-action:pan-x;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;}/*!sc*/
.cwSObj .styledDarkModeToogle__SwitchContainer-sc-9n1pc7-0{background-color:#123;}/*!sc*/
.cwSObj .styledDarkModeToogle__SwitchCircle-sc-9n1pc7-1{background-color:#DEF;left:2px;}/*!sc*/
.cwSObj .styledDarkModeToogle__SwitchIconLeft-sc-9n1pc7-3{opacity:0;}/*!sc*/
.cwSObj .styledDarkModeToogle__SwitchIconRight-sc-9n1pc7-4{opacity:1;}/*!sc*/
data-styled.g8[id="styledDarkModeToogle__SwitchWrapper-sc-9n1pc7-5"]{content:"cwSObj,"}/*!sc*/
</style></head><body><script>!function(e,a,o){function d(e){document.body.classList.add(e?"dark-mode":"light-mode"),document.body.classList.remove(e?"light-mode":"dark-mode")}var t=window.matchMedia("(prefers-color-scheme: dark)"),r="(prefers-color-scheme: dark)"===t.media,s=null;try{s=localStorage.getItem("darkMode")}catch(e){}var c=null!==s;if(c&&(s=JSON.parse(s)),c)d(s);else if(r)d(t.matches),localStorage.setItem("darkMode",t.matches);else{var l=document.body.classList.contains("dark-mode");localStorage.setItem("darkMode",JSON.stringify(l))}}();</script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main><h1>Gatsby Dark Mode Bug</h1><div><div aria-checked="false" role="switch" tabindex="0" class="styledDarkModeToogle__SwitchWrapper-sc-9n1pc7-5 cwSObj"><div class="styledDarkModeToogle__SwitchContainer-sc-9n1pc7-0 eftICK"><div class="styledDarkModeToogle__SwitchIcon-sc-9n1pc7-2 styledDarkModeToogle__SwitchIconLeft-sc-9n1pc7-3 erBfQD hDnQUW"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#321" style="color:#321" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></div><div class="styledDarkModeToogle__SwitchIcon-sc-9n1pc7-2 styledDarkModeToogle__SwitchIconRight-sc-9n1pc7-4 erBfQD cfkHgN"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" color="#DEF" style="color:#DEF" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></div></div><div class="styledDarkModeToogle__SwitchCircle-sc-9n1pc7-1 boyQdn"></div></div> <!-- --><em>Change theme</em></div><p>Changing between themes works fine in development, but once the the Gatsby application gets built, the custom component&#x27;s dark styles don&#x27;t get applied when (re)loading the page. You can check out a deployed version of the page here:<!-- --> <!-- --><a href="https://stekhn.github.io/gatsby-dark-mode/">https://stekhn.github.io/gatsby-dark-mode/</a></p><div class="styledBox__Box-sc-yambj8-0 dOgQpc"><p>I&#x27;m a custom component (Box) and my style should always match the rest of the page. I get my styles from a global <!-- --><code>theme</code>, which gets injected by the <!-- --><code>ThemeProvider</code>.<!-- --></p><p>For example, this is how my background color is defined:</p><code>background-color: ${({ theme }) =&gt; theme.background};</code></div><p>The dark mode for this site was implemented using the<!-- --> <!-- --><a href="">use-dark-mode</a> React hook and the<!-- --> <!-- --><a href="https://styled-components.com/docs/advanced#theming">styled-components ThemeProvider</a> <!-- -->component.<!-- --></p></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/";window.___webpackCompilationHash="099fd52508794f188ba3";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-83f854102e1e42890db3.js"],"app":["/app-f0efc7d2011e8e7fafe9.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-58af5e05f05ff7fcd893.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-55acd1f4c1c8b34b2b1f.js"]};/*]]>*/</script><script src="/polyfill-83f854102e1e42890db3.js" nomodule=""></script><script src="/app-f0efc7d2011e8e7fafe9.js" async=""></script><script src="/framework-097831ed07cdd740d5b3.js" async=""></script><script src="/webpack-runtime-c53899e1d9086f411e0a.js" async=""></script></body></html>